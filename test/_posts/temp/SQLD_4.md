---
author_profile: true
date: 2021-08-20
title: "SQLD 4 - 데이터 모델링 및 성능"
categories: 
    - SQL
tag: 
    - ORACLE
    - SQLD

# 목차
toc: true  
toc_sticky: true 
# sidebar:
#  nav: "docs"
---

# SQLD -데이터 모델과 성능(정규화, 반정규화)

---

## 1. 성능 데이터 모델링 고려 사항

- 데이터 모델링 시 정규화 작업을 수행한다.
- 데이터베이스 용량을 산정한다.
- 데이터 베이스에 발생되는 트랜젝션의 유형을 파악한다.
- 데이터베이스 용량 및 트랜잭션의 유형에 따라 반정규화를 수행한다.
- 이력 데이터 모델의 조정, PK, FK조정, 슈퍼/서브타입 반환 조정등을 수행한다.
- 성능 관점에서 데이터 모델을 검증한다.

## 2. 정규화 용어

|용어|설명|
|-|-|
|정규화(Nomalization)|함수적 종속성 등과 같은 이론에 근거하여 관계형 DB 테이블의 삽입/삭제/갱신 이상현상을 최소화하기 위해 좀 더 작은 단위의 테이블로 설계하는 과정이다. 즉, 정규화는 데이터 모델을 정규형에 맞도록 고치는 과정이다.|
|정규형(NF:Nomal Form)|정규화한 결과라고 할 수 있으며, 정규화 결과에 의해 도출된 데이터 모델이 갖퉈야 할 특성을 만족한 형태|
|함수적 종속성(FD: Functional Dependency)|테이블의 특정 컬럼 A의 값을 알면 다른 컬럼 B 값을 알 수 있을때 칼럼 B는 칼럼 A에 함수적 종속성에 있다라고 한다.(Ex. 주민번호를 알면 고객명을 알 수 있을 때 고객명은 주민등록번호에 함수저거 종속성이 있다. 라고 한다.) |
|결정자(Determinant)|위의 함수적 종속성 설명에서 칼럼 A를 결정자라고 한다. (Ex. 주민번호는 고객명을 결정하는 고객명의 결정자 이다.)|
|다치종속(MVD:MultiValued Dependency)|결정자 컬럼 A에 의해 칼럼 B의 값을 다수개 알 수 있을 때 B는 칼럼 A에 다치 종속되어 있다고 한다.(Ex. 학번을 통해 해당 학생이 수강신청한 다수 개의 수강과목을 알 수 있을 때 '수강과목은 학번에 다치 종속된다.'라고 할 수 있다.)|

## 3. 정규화 이론

### 정규화 효과 및 장점

- 정규화는 상호 종속성이 강한 데이터 요소들을 분리, 독립된 개념(엔티티, 테이블)으로 정의하게 됨에 따라 높은 응집도 & 낮은 결합도 원칙에 충실해지며, 이로인해 유연성 증가.

### 정규화 이론

|정규화|수행내용|설명|
|---|---|---|
|비정규 R| | |
|↓|도메인이 원자 값|한 속성에 여러개의 속성값을 갖거나 같은 유형의 속성이 여러 개인 경우 속성을 분리시킨다. 이로 인해 속성의 원자성을 확보한다.|
|1NF| | |
|↓|부분적 함수 종속 제거|주 식별자에 완전 함수 종속되지 않은 속성을 분리한다. 2차 정규화 작업으로 부분 종속 속성이 된 속성을 분리한다.|
|2NF| | |
|↓|이행적 함수 종속 제거|일반 속성끼리 함수 종속이 발생한 속성을 분리한다. 3차 정규화 작업으로 이행적 종속 속성을 제거한다.|
|3NF| | |
|↓|결정자 이면서 후보키가 아닌것 제거|결정자 안에 함수 종속을 가진 주식별자 속성을 분리한다.|
|BCNF| | |
|↓|다치 종속 제거|다가 종속 속성을 별도의 엔티티로 분리한다.|
|4NF| | | 
|↓|조인 종속성 이용|결합 종속일 경우는 2개 이상의 엔티티로 분리한다.
|5NF| | |



### 제 1정규형

- 회원 엔티티

|회원 아이디|나이|성별|회원구분|연락처|
|-|-|-|-|-|
|sujilee|3|여|프리미엄|010-1234-5678, sujilee@naver.com|

> 한 속성에 여러개의 속성 값을 갖거나 같은 속성이 여러개 인경우 해당 속성으 분리 시킨다. 연락처 중복

- 회원 엔티티

|회원 아이디|나이|성별|회원구분|
|-|-|-|-|
|sujilee|3|여|프리미엄|

- 회원 연락처 엔티티

|회원 아이디|연락처 구분|연락처|
|-|-|-|
|sujilee|휴대폰|010-1234-5678|
|sujilee|이메일|sujilee@naver.com|


### 제 2정규형

제 2정규형은 제 1정규형을 만족하고 모든 PK가 아닌 컬럼은 PK 전체에 종속되어야 한다. 

- 위반한 테이블(고객주문 엔티티)

|고객아이디|주문순번|주문일자|고객명|고객등급|
|C00001|000001|20200505|이경오|프리미엄|
|C00001|000002|20200505|이경오|프리미엄|
|C00001|000003|20200505|이경오|프리미엄|

> 고객주문 엔티티의 식별자(PK)는 고객아이디+주문순번이다. 하지만, 고객주문 엔티티에서 고객명과 고객등급 속성은 이 엔티티의 복합 식별자에 완전 종속되지 않는다.

- 2정규형으로 변환(고객 주문 엔티티)

|고객아이디|주문순번|주문일자|
|-|-|-|
|C00001|000001|20200505|
|C00001|000002|20200505|
|C00001|000003|20200505|

- 고객 엔티티

|고객아이디|고객명|고객등급|
|-|-|-|
|C00001|이경오|프리미엄|

### 제 3정규형

제3 정규형은 제2 정규형을 만족하고 일반 속성들 간에도 함수 종속관계가 존재하지 않아야 한다.

- 위반한 테이블(고객 엔티티)

|고객 아이디(PK)|고객명|나이|직업코드|작업명|
|-|-|-|-|-|
|C00001|이경오|36|J001|SQL 개발자|
|C00002|이수지|27|J002|변호사|
|C00003|이나라|25|J003|미용사|

> 고객 엔티티의 식별자는 고객 아이디이다. 고객 아이디 속성을 제외하고 일반 속성인 직업코드와 직업명 속성간에 함수적 종속이 발생.

- 제 3정규형으로 변환(고객 엔티티)

|고객아이디(PK)|고객명|나이|직업코드|
|-|-|-|-|
|C00001|이경오|36|J001|
|C00002|이수지|27|J002|
|C00003|이나라|25|J003|

- 제 3정규형으로 변화(직업 엔티티)

|직업코드(PK)|직업명|
|-|-|
|J001|SQL 개발자|
|J002|변호사|
|J003|미용사|


## 4. 반정규화

- 시스템의 성능 향상 및 개발과 유지보수의 단순화를 위해 반정규화는 정규화된 데이터 모델을 분석하여 엔티티/속성/관계를 중복, 통합, 분리 등의 작업으로 수행하는 데이터 모델링 기법.

### 반정규화 기법

- 테이블 병합
  - 1:1 관계 테이블 병합
    - 1:1 관계를 통합하여 성능을 향상시키는 방법이다.
    - 2개의 테이블을 하나의 테이블로 병합하여 테이블 간 조인 연산을 제거한다.
  - 1:M 관계 테이블 병합
    - 1:M 관계를 통합하여 성능을 향상시키는 방법
    - 2개의 테이블을 하나의 테이블로 병함하여 테이블 간 조인 연산을 제게한다.
  - 슈퍼/서브 타입 테이블 병합
    - 슈퍼/서브 관계를 통합하여 성능을 향상시키는 방법
- 테이블 분할
  - 수직 분할
    - 칼럼단위의 테이블을 디스크 IO분산처리하기 위해 테이블을 1:1로 분리하여 성능을 향상시키는 방법으로 트랜젝션이 처리되는 유형 파악이 선행되어야 한다.
  - 수평 분할
    - 로우 단위로 집중발생되는 트랜잭션을 분석하여 디스크 IO 및 데이터 접근 효율을 높여 성능을 향상하기 위해 로우 단위로 테이블을 쪼개는 방법
- 테이블 추가
    - 중복 테이블 추가 
      - 다른 업무이거나 서버가 다른경우 동일한 테이블 구조를 중복하여 원격 조인을 제거하여 성능 향상
    - 통계 테이블 추가
      - SUM, AVG등을 미리 수행하여 계산해 둠으로써 조회 시 성능을 향상시킨다.
    - 이력 테이블 추가
      - 이력테이블 중에서 마스터 테이블에 존재하는 레코드를 중복하여 이력 테이블에 저장하는 반정규화 기법
    - 부분 테이블 추가
      - 특정 테이블에서 전체 칼럼 중 자주 이용하는 집중화된 컬럼들이 있을 때, 디스크 IO를 줄이기 위해 해당 칼럼들을 모아 놓은 반 정규화된 테이블을 생성한다.

## 5. 분산 DB

### 분산 데이터 베이스의 투명성

- 분할 투명성
- 위치 투명성
- 지역사상 투명성
- 중복 투명성
- 장애투명성
- 병행 투명성

### 분산 DB의 장점

- 지역자치성, 점층적 시스템 용량 확장
- 신뢰성과 가용성
- 효용성과 융통성
- 빠른 응답 속도와 통신비용 절감
- 데이터의 가용성과 신뢰성 증가
- 시스템 규모의 적절한 조절
- 각 지역 사용자듸 요구 수용 증대

### 분산 DB의 단점

- 소프트웨어 개발 비용
- 오류 잠재성 증대
- 처리 비용의 증대
- 설계 및 관리의 복잡성과 비용
- 불규칙한 응답속도
- 통제의 어려움
- 데이터 무결성에 대한 위협
  